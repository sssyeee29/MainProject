<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>ECOVERY - ÎßàÏù¥ÌéòÏù¥ÏßÄ</title>
    <!-- Ìó§Îçî/Ìë∏ÌÑ∞ CSS Ï∂îÍ∞Ä -->
    <link rel="stylesheet" href="/css/header.css">
    <link rel="stylesheet" href="/css/footer.css">
    <!-- ÎßàÏù¥ÌéòÏù¥ÏßÄ CSS -->
    <link rel="stylesheet" th:href="@{/css/mypage-style.css}">
    <!-- Ìè∞Ìä∏ -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
<div th:replace="fragments/header :: header"></div>

    <!-- Î©îÏù∏ ÏΩòÌÖêÏ∏† ÏòÅÏó≠ -->
    <main id="mainContent">
        <!-- ÌîÑÎ°úÌïÑ Ìó§Îçî ÏÑπÏÖò -->
        <section class="profile-header">
            <div class="container">
                <div class="profile-banner">
                    <!-- ÌîÑÎ°úÌïÑ Ï†ïÎ≥¥ ÏÑπÏÖò -->
                    <div class="profile-info">
                        <div class="profile-details">
                            <!-- ÏÇ¨Ïö©Ïûê Ïù¥Î¶ÑÍ≥º Ìé∏Ïßë ÏïÑÏù¥ÏΩò -->
                            <div class="user-name-container">
                                <h1 class="user-name" th:text="${member.nickname + 'Îãò'}">ÍπÄÌôòÍ≤ΩÎãò</h1>
                                <!-- ÌöåÏõêÏ†ïÎ≥¥ ÏàòÏ†ï ÏïÑÏù¥ÏΩò -->
                                <button class="edit-profile-icon" onclick="openProfileModal()" aria-label="ÌöåÏõêÏ†ïÎ≥¥ ÏàòÏ†ï">
                                    <i class="edit-icon">‚úèÔ∏è</i>
                                </button>
                            </div>

                            <!-- ÏÇ¨Ïö©Ïûê Ïù¥Î©îÏùº -->
                            <p class="user-email" th:text="'Ïù¥Î©îÏùº : ' + ${member.email}">Ïù¥Î©îÏùº : green@greencycle.com</p>

                            <!-- Í∞ÄÏûÖ Ï†ïÎ≥¥ -->
                            <div class="join-info">
                                <span th:text="'Í∞ÄÏûÖÏùº : ' + ${#dates.format(member.createdAt, 'yyyy.MM.dd')}">Í∞ÄÏûÖÏùº : 2025.07.25</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ÎåÄÏãúÎ≥¥Îìú Î©îÏù∏ Ïª®ÌÖåÏù¥ÎÑà -->
        <section class="dashboard-main">
            <div class="container">
                <!-- ÎåÄÏãúÎ≥¥Îìú Í∑∏Î¶¨Îìú Î†àÏù¥ÏïÑÏõÉ -->
                <div class="dashboard-grid">

                    <!-- 2. Íµ¨Îß§ ÎÇ¥Ïó≠ ÏÑπÏÖò -->
                    <div class="dashboard-card purchase-history">
                        <div class="card-header">
                            <h3>üì¶ Íµ¨Îß§ ÎÇ¥Ïó≠</h3>
                            <button class="btn-small" th:onclick="|location.href='@{/orders/list}'|">
                                Ï†ÑÏ≤¥Î≥¥Í∏∞
                            </button>
                        </div>
                        <div class="card-content">
                            <!-- Íµ¨Îß§ ÌÜµÍ≥Ñ -->
                            <div class="purchase-stats">
                                <div class="stat-item">
                                    <span class="stat-number">5</span>
                                    <span class="stat-label">Ïù¥Î≤à Îã¨</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-number">‚Ç©124,000</span>
                                    <span class="stat-label">Ï¥ù Íµ¨Îß§Ïï°</span>
                                </div>
                            </div>

                            <!-- ÏµúÍ∑º Íµ¨Îß§ ÎÇ¥Ïó≠ -->
                            <div class="recent-purchases">
                                <h4>ÏµúÍ∑º Ï£ºÎ¨∏</h4>
                                <div class="purchase-list">
                                    <div class="purchase-item" data-order-id="ORD001">
                                        <div class="item-info">
                                            <span class="item-name">ÏπúÌôòÍ≤Ω ÏÑ∏Ï†ú ÏÑ∏Ìä∏</span>
                                            <span class="item-date">2024.07.20</span>
                                        </div>
                                        <span class="item-status delivered">Î∞∞ÏÜ°ÏôÑÎ£å</span>
                                    </div>
                                    <div class="purchase-item" data-order-id="ORD002">
                                        <div class="item-info">
                                            <span class="item-name">Ïû¨ÌôúÏö© ÌÖÄÎ∏îÎü¨</span>
                                            <span class="item-date">2024.07.18</span>
                                        </div>
                                        <span class="item-status shipping">Î∞∞ÏÜ°Ï§ë</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 3. ÎÇòÎàî Í¥ÄÎ¶¨ ÏÑπÏÖò -->
                    <div class="dashboard-card sharing-management">
                        <div class="card-header">
                            <h3>ü§ù ÎÇòÎàî Í¥ÄÎ¶¨</h3>
                            <button class="btn-small" th:onclick="|location.href='@{/free/list}'|">
                                ÎÇòÎàî Îì±Î°ù
                            </button>
                        </div>
                        <div class="card-content">
                            <!-- ÎÇòÎàî ÌÜµÍ≥Ñ -->
                            <div class="sharing-stats">
                                <div class="stat-item">
                                    <span class="stat-number">3</span>
                                    <span class="stat-label">ÏßÑÌñâÏ§ë</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-number">12</span>
                                    <span class="stat-label">ÏôÑÎ£å</span>
                                </div>
                            </div>

                            <!-- ÎÇòÎàî ÌôúÎèô -->
                            <div class="sharing-activities">
                                <h4>ÎÇòÏùò ÎÇòÎàî</h4>
                                <div class="sharing-list">
                                    <div class="sharing-item">
                                        <div class="item-info">
                                            <span class="item-name">ÏïÑÏù¥ Ï†ÑÏßë ÎèÑÏÑú</span>
                                            <span class="item-location">üìç Í∞ïÎÇ®Íµ¨</span>
                                        </div>
                                        <span class="item-status available">ÎÇòÎàîÏ§ë</span>
                                    </div>
                                    <div class="sharing-item">
                                        <div class="item-info">
                                            <span class="item-name">Ïú†ÏïÑ Ïû•ÎÇúÍ∞ê</span>
                                            <span class="item-location">üìç ÏÑúÏ¥àÍµ¨</span>
                                        </div>
                                        <span class="item-status completed">ÏôÑÎ£å</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 4. Î∂ÑÎ¶¨Î∞∞Ï∂ú ÎÇ¥Ïó≠ ÏÑπÏÖò -->
                    <div class="dashboard-card waste-history">
                        <div class="card-header">
                            <h3>‚ôªÔ∏è Î∂ÑÎ¶¨Î∞∞Ï∂ú ÎÇ¥Ïó≠</h3>
                            <button class="btn-small" th:onclick="|location.href='@{/disposal/disposalMain}'|">
                                ÏÉà Î∞∞Ï∂ú
                            </button>
                        </div>
                        <div class="card-content">
                            <!-- Î∂ÑÎ¶¨Î∞∞Ï∂ú ÌÜµÍ≥Ñ -->
                            <div class="waste-stats">
                                <div class="stat-item">
                                    <span class="stat-number">47</span>
                                    <span class="stat-label">Ïù¥Î≤à Îã¨</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-number">12.3kg</span>
                                    <span class="stat-label">CO‚ÇÇ Ï†àÏïΩ</span>
                                </div>
                            </div>

                            <!-- ÏµúÍ∑º Î∞∞Ï∂ú ÎÇ¥Ïó≠ -->
                            <div class="waste-activities">
                                <h4>ÏµúÍ∑º ÌôúÎèô</h4>
                                <div class="waste-list">
                                    <div class="waste-item">
                                        <div class="waste-icon plastic">‚ôªÔ∏è</div>
                                        <div class="item-info">
                                            <span class="item-name">ÌîåÎùºÏä§Ìã± Î≥ë</span>
                                            <span class="item-date">3ÏãúÍ∞Ñ Ï†Ñ</span>
                                        </div>
                                        <span class="reward-points">+15P</span>
                                    </div>
                                    <div class="waste-item">
                                        <div class="waste-icon paper">üìÑ</div>
                                        <div class="item-info">
                                            <span class="item-name">Ï¢ÖÏù¥Î•ò</span>
                                            <span class="item-date">1Ïùº Ï†Ñ</span>
                                        </div>
                                        <span class="reward-points">+10P</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 5. Ìè¨Ïù∏Ìä∏ ÎÇ¥Ïó≠ ÏÑπÏÖò -->
                    <div class="dashboard-card points-history">
                        <div class="card-header">
                            <h3>üíé Ìè¨Ïù∏Ìä∏ ÎÇ¥Ïó≠</h3>
                            <button class="btn-small" th:onclick="|location.href='@{/mypage/points}'|">
                                Ï†ÑÏ≤¥Î≥¥Í∏∞
                            </button>
                        </div>
                        <div class="card-content">
                            <!-- Ìè¨Ïù∏Ìä∏ ÏöîÏïΩ -->
                            <div class="points-summary">
                                <div class="current-points">
                                    <span class="points-amount">15,680P</span>
                                    <span class="points-label">Î≥¥Ïú† Ìè¨Ïù∏Ìä∏</span>
                                </div>
                                <div class="points-change">
                                    <span class="points-earned">+2,340P</span>
                                    <span class="period-label">Ïù¥Î≤à Îã¨</span>
                                </div>
                            </div>

                            <!-- ÏµúÍ∑º Ìè¨Ïù∏Ìä∏ ÎÇ¥Ïó≠ -->
                            <div class="points-activities">
                                <h4>ÏµúÍ∑º Ï†ÅÎ¶Ω/ÏÇ¨Ïö©</h4>
                                <div class="points-list">
                                    <div class="points-item earn">
                                        <div class="item-info">
                                            <span class="item-desc">Î∂ÑÎ¶¨Î∞∞Ï∂ú ÏôÑÎ£å</span>
                                            <span class="item-date">3ÏãúÍ∞Ñ Ï†Ñ</span>
                                        </div>
                                        <span class="points-value">+15P</span>
                                    </div>
                                    <div class="points-item use">
                                        <div class="item-info">
                                            <span class="item-desc">ÏπúÌôòÍ≤Ω ÏÑ∏Ï†ú Íµ¨Îß§</span>
                                            <span class="item-date">2Ïùº Ï†Ñ</span>
                                        </div>
                                        <span class="points-value">-500P</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </section>

        <!-- ÌöåÏõêÏ†ïÎ≥¥ ÏàòÏ†ï Î™®Îã¨ -->
        <div id="profileModal" class="modal-overlay" onclick="closeProfileModal()">
            <div class="modal-content" onclick="event.stopPropagation()">
                <div class="modal-header">
                    <h3>ÌöåÏõêÏ†ïÎ≥¥ ÏàòÏ†ï</h3>
                    <button class="modal-close" onclick="isFormDirty = false; closeProfileModal()" aria-label="Î™®Îã¨ Îã´Í∏∞">√ó</button>
                </div>
                <div class="modal-body">
                    <form id="profileEditForm" method="post">
                        <!-- ÎãâÎÑ§ÏûÑ ÏàòÏ†ï Î∂àÍ∞Ä -->
                        <div class="form-group">
                            <label for="editNickname">ÎãâÎÑ§ÏûÑ</label>
                            <div class="input-group">
                                <input type="text" id="editNickname" class="form-control" th:value="${member.nickname}" readonly style="background-color: darkgray;">
                            </div>
                        </div>

                        <!-- Ïù¥Î©îÏùº ÏàòÏ†ï Î∂àÍ∞Ä -->
                        <div class="form-group">
                            <label for="editEmail">Ïù¥Î©îÏùº</label>
                            <div class="input-group">
                                <input type="email" id="editEmail" class="form-control" th:value="${member.email}" style="background-color: darkgray;">
                            </div>
                        </div>

                        <!-- ÎπÑÎ∞ÄÎ≤àÌò∏ Î≥ÄÍ≤Ω -->
                        <div class="form-group">
                            <label for="currentPassword">ÌòÑÏû¨ ÎπÑÎ∞ÄÎ≤àÌò∏</label>
                            <input type="password" id="currentPassword" placeholder="ÌòÑÏû¨ ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                            <div id="currentPasswordError" class="validation-message error-hidden">ÌòÑÏû¨ ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä ÎßûÏßÄ ÏïäÏäµÎãàÎã§.</div>
                        </div>

                        <div class="form-group">
                            <label for="newPassword">ÏÉà ÎπÑÎ∞ÄÎ≤àÌò∏</label>
                            <input type="password" id="newPassword" placeholder="ÏÉà ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                            <div id="newPasswordError" class="validation-message error-hidden">ÏòÅÎ¨∏/Ïà´Ïûê/ÌäπÏàòÎ¨∏Ïûê Ìè¨Ìï® 8Ïûê Ïù¥ÏÉÅÏù¥Ïó¨Ïïº Ìï©ÎãàÎã§.</div>
                        </div>

                        <div class="form-group">
                            <label for="confirmPassword">ÏÉà ÎπÑÎ∞ÄÎ≤àÌò∏ ÌôïÏù∏</label>
                            <input type="password" id="confirmPassword" placeholder="ÏÉà ÎπÑÎ∞ÄÎ≤àÌò∏Î•º Îã§Ïãú ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
                            <div id="confirmPasswordError" class="validation-message error-hidden">ÏûëÏÑ±ÌïòÏã† ÏÉà ÎπÑÎ∞ÄÎ≤àÌò∏ÏôÄ ÎßûÏßÄ ÏïäÏäµÎãàÎã§.</div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="isFormDirty = false; closeProfileModal();">Ï∑®ÏÜå</button>
                    <button type="button" class="btn-primary" onclick="saveProfileChanges()">Ï†ÄÏû•</button>
                </div>
            </div>
        </div>

    </main>
<div th:replace="fragments/footer :: footer"></div>
<script src="/js/mypage-script.js"></script>
</body>
</html>