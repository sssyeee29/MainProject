<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout1}">

<head th:with="pageTitle='에코마켓'">
    <title>에코마켓 수정/삭제 - 환경보호 플랫폼</title>

    <th:block layout:fragment="css">
        <link rel="stylesheet" href="/css/header.css">
        <link rel="stylesheet" href="/css/footer.css">
        <link rel="stylesheet" th:href="@{/css/eco-market-edit.css}">
    </th:block>
</head>

<!-- 메인 콘텐츠 영역 -->
<main class="main-content">
    <div class="container" layout:fragment="content">
        <!-- 현재 위치 표시 (빵부스러기) -->
        <section class="breadcrumb">
            <div class="container">
                <nav class="breadcrumb-nav">
                    <a th:href="@{/}">🏠</a>
                    <span>></span>
                    <a th:href="@{/eco/list}">에코마켓</a>
                    <span>></span>
                    <span class="current">상품 수정</span>
                </nav>
            </div>
        </section>

        <!-- 페이지 제목 -->
        <section class="page-header">
            <div class="container">
                <h1 class="page-title">🛒 에코마켓 상품 수정</h1>
                <p class="page-subtitle">기존 등록된 상품 정보를 수정할 수 있습니다</p>
            </div>
        </section>

        <!-- 수정 폼 -->
        <section class="registration-section">
            <div class="container">
                <div class="form-container">
                    <div class="form-header">
                        <h2>상품 정보 수정하기</h2>
                        <p>정확하게 수정하면 더 많은 구매자에게 어필할 수 있어요</p>
                    </div>

                    <!-- 실제 폼 : id/구조/네이밍 "등록"과 동일! -->
                    <form class="form-body" id="editForm" enctype="multipart/form-data">

                        <!-- 상품명 입력 -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">상품명 <span class="required">*</span></label>
                            </div>
                            <div class="form-input-section">
                                <input type="text" class="form-input" name="itemNm" id="itemNm" placeholder="상품명을 입력해주세요" required />

                                <div class="error-message" id="productNameError"></div>
                            </div>
                        </div>

                        <!-- 등록일(수정일) -->
                        <!--<div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">등록일</label>
                            </div>
                            <div class="form-input-section">
                                <input type="text"
                                       class="form-input"
                                       id="regDate"
                                       name="regDate"
                                       readonly>
                            </div>
                        </div>-->

                        <!-- 카테고리 -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">카테고리 <span class="required">*</span></label>
                            </div>
                            <div class="form-input-section">
                                <select class="form-select" name="categoryId" id="categoryId" required>
                                    <!-- JS로 옵션/선택값 반영 -->
                                </select>
                                <div class="error-message" id="categoryError"></div>
                                <div class="help-text">현재 상품의 카테고리를 정확히 선택해주세요.</div>
                            </div>
                        </div>

                        <!-- 상품 판매 상태 -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">판매 상태 <span class="required">*</span></label>
                            </div>
                            <div class="form-input-section">
                                <select class="form-select" name="itemSellStatus" id="itemSellStatus" required>
                                    <option value="">판매 상태를 선택해주세요</option>
                                    <option value="SELL">판매중</option>
                                    <option value="SOLD_OUT">품절</option>
                                </select>
                                <div class="error-message" id="saleStatusError"></div>
                                <div class="help-text">현재 상품의 판매 상태를 정확히 선택해주세요.</div>
                                <div class="condition-preview" id="conditionPreview"></div>
                            </div>
                        </div>

                        <!-- 가격 정보 -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">가격정보 <span class="required">*</span></label>
                            </div>
                            <div class="form-input-section">
                                <div class="price-group">
                                    <div class="price-input-wrapper">
                                        <input type="number" class="form-input price-input" name="price" id="price" min="1000" required />
                                        <span class="currency">원</span>
                                    </div>
                                </div>
                                <div class="error-message" id="priceError"></div>
                                <div class="help-text">최소 1,000원 이상부터 등록 가능합니다.</div>
                                <div class="price-analysis" id="priceAnalysis"></div>
                            </div>
                        </div>

                        <!-- 재고 수량 -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">재고 수량 <span class="required">*</span></label>
                            </div>
                            <div class="form-input-section">
                                <div class="stock-group">
                                    <div class="stock-input-wrapper">
                                        <input type="number" class="form-input stock-input" name="stockNumber" id="stockNumber" min="1" required />
                                        <span class="currency">개</span>
                                    </div>
                                </div>
                                <div class="error-message" id="stockError"></div>
                                <div class="help-text">최소 1개 이상부터 등록 가능합니다.</div>
                                <div class="stock-analysis" id="stockAnalysis"></div>
                            </div>
                        </div>

                        <!-- 상품 설명 -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label">상품설명 <span class="required">*</span></label>
                            </div>
                            <div class="form-input-section">
                                <textarea class="form-input form-textarea" name="itemDetail" id="itemDetail" required></textarea>
                                <div class="error-message" id="descriptionError"></div>
                                <div class="help-text">고객이 쉽게 이해할 수 있도록 상품 정보를 구체적으로 적어 주세요.</div>
                            </div>
                        </div>

                        <!-- 사진 업로드/미리보기 -->
                        <div class="form-row">
                            <div class="form-label-section">
                                <label class="form-label" for="imageInput">상품사진 <span class="required">*</span></label>
                            </div>
                            <div class="form-input-section">
                                <div class="image-preview" id="imagePreview"></div>
                                <div class="image-upload-area" id="imageUploadArea">
                                    <div class="upload-icon">📷</div>
                                    <div class="upload-text">상품 사진을 업로드하거나 여기를 클릭하세요</div>
                                    <div class="upload-hint">최대 5개까지 업로드 가능 (JPG, PNG) - 첫 번째 사진이 대표 이미지가 됩니다</div>
                                </div>
                                <input type="file" name="itemImgFile" id="imageInput" multiple accept="image/*" style="display: none;">
                                <div class="error-message" id="imagesError"></div>
                                <div class="help-text">
                                    💡 <strong>이미지 등록 안내:</strong> 고객이 상품을 정확히 이해할 수 있도록, 선명하고 다양한 각도의 이미지를 등록해 주세요.<br>
                                    대표 이미지가 첫 번째 사진으로 설정되며, 이미지가 많을수록 상품 신뢰도가 올라갑니다!
                                </div>
                            </div>
                        </div>
                    </form>

                    <!-- 폼 버튼들 -->
                    <div class="form-actions">
                        <button type="button" class="btn btn-cancel" id="cancelBtn">취소</button>
                        <button type="submit" class="btn btn-submit" form="editForm">상품 수정</button>
                    </div>
                </div>
            </div>
        </section>
    </div>
</main>

<!-- 추가 JS -->
<th:block layout:fragment="script">

    <script th:src="@{/js/eco-market-edit.js}"></script>

    <script>
        const itemId = /*[[${itemId}]]*/ '0';
    </script>

</th:block>


</html>
